<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <title>网上书城</title>
    <style>
        #bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        #bg canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body onload = "initAJAX();getUserName();showBook('全部')" style=" background-repeat:no-repeat;background-size:100% 100%;background-attachment: fixed;padding: 0%;margin: 0%">
        <div id="bg">
            <canvas></canvas>
            <canvas></canvas>
            <canvas></canvas>
        </div>
        <div class = "page-header" style="margin: 0% 15% 0% 15%; background-color:powderblue;padding: 0;border: 0">
            <div id = "top" class = "row">
                <div id = "top_left" class = "col-sm-4 text-right">
                    <img src = "images/logo.ico" width="100" height = "100"/>
                </div>
                <div class="col-sm-4" style = "margin-top: 20px">
                        <h1 class = "text-primary" style = "font-family: STHupo">我的网上书城</h1>
                </div>
                <div id = "top_right" class = "col-sm-4" style = "margin-top: 70px; font-family: SKKaiti; font-size: 15px">
                    欢迎进入XXX网上书城，请<a href = "login.html">登录</a>或<a href = "register.html">注册</a>！
                </div>
            </div>
        </div>
        <div id = "body">
            <div id = "nav" style = "margin:0% 15% 0% 15%;border:0; color: darkturquoise;background-color: white;border: 0">
                <ul class="nav nav-pills nav-justified">
                    <li><a href="javascript:showBook('全部')">全部</a></li>
                    <li><a href="javascript:showBook('文学')">文学</a></li>
                    <li><a href="javascript:showBook('生活')">生活</a></li>
                    <li><a href="javascript:showBook('外语')">外语</a></li>
                    <li><a href="javascript:showBook('经管')">经管</a></li>
                    <li><a href="javascript:showBook('励志')">励志</a></li>
                    <li><a href="javascript:showBook('社科')">社科</a></li>
                    <li><a href="javascript:showBook('学术')">学术</a></li>
                    <li><a href="javascript:showBook('艺术')">艺术</a></li>
                    <li><a href="javascript:showBook('科技')">科技</a></li>
                </ul>
            </div>
        </div>
        <div style="background-color:white;width: 70%;margin-left: 15%;" >
            <img src = "images/guanggao.jpg" width="100%" height="200px">
        </div>
        <hr style = "margin:0% 15% 0% 15%;color: white;background-color: white;height: 10px">
        <div class = "row" style = "margin-left: 15%; margin-right: 15%;background-color: white">
            <div id="myCarousel" class="carousel slide col-sm-8">
                <!-- 轮播（Carousel）指标 -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active" data-interval="1000"></li>></li>
                    <li data-target="#myCarousel" data-slide-to="1" data-interval="1000"></li>></li>
                    <li data-target="#myCarousel" data-slide-to="2" data-interval="1000"></li>></li>
                    <li data-target="#myCarousel" data-slide-to="3" data-interval="1000"></li>></li>
                </ol>   
                <!-- 轮播（Carousel）项目 -->
                 <div class="carousel-inner" style = "height: 300px">
                    <div class="item active">
                        <img src="images/lunbo1.jpg" style = "height: 300px;width: 100%">
                    </div>
                    <div class="item">
                        <img src="images/lunbo2.jpg" style = "height: 300px;width: 100%">
                    </div>
                    <div class="item">
                        <img src="images/lunbo3.jpg" style = "height: 300px;width: 100%">
                    </div>
                    <div class="item">
                        <img src="images/lunbo4.jpg" style = "height: 300px;width: 100%">
                    </div>
                </div>
                <!-- 轮播（Carousel）导航 -->
                <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <div class = "col-sm-4">
                <h3><strong>最新动态</strong></h3>
                <ul class="list-group" style = "margin: 0%;padding: 0;">
                    <li class="list-group-item"><a href = "#">文艺阅读，每满150减50</a></li>
                    <li class="list-group-item"><a href = "#">双十一促销火热进行中</a></li>
                    <li class="list-group-item">
                        <span class="badge" style = "background-color: red">热</span>
                        <a href = "#">计算机类书籍每满200减100</a></li>
                    <li class="list-group-item">
                        <span class="badge" style = "background-color: red">热</span>
                        <a href = "#">双十二图书促销预热，1元抢100元劵</a>
                    </li>
                    <li class="list-group-item"><a href = "#">新书速递11月刊</a></li>
                    <li class="list-group-item">
                        <span class="badge" style="background-color:blue">新</span>
                        <a href = "#">限时折扣优惠</a>
                    </li>
                </ul>
            </div> 
        </div>
        <hr style = "margin:0% 15% 0% 15%;color: white;background-color: white;height: 10px;border: 0">
        <div id = "book" style = "margin:0% 15% 0% 15%;background-color: white; height: 600px;">
        
        </div>
    <script src="js/jquery.min.js" ></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/commons.js"></script>
    <script src="js/canva_moving_effect.js"></script>
    <script language="JavaScript">
        function showBook(category) {
            if(category=="全部") {
                xmlHttp.open("GET", "/book/allBooks", true);
                xmlHttp.onreadystatechange = function () {
                    if (xmlHttp.readyState == 4) {
                        var data = xmlHttp.responseText;
                        var obj = JSON.parse(data);
                        var listbook = '';
                        for (var i in obj) {
                            var bookname = obj[i].name;
                            var desc = obj[i].introduction;
                            var imgurl = obj[i].imgurl;
                            if (desc.length > 20) {
                                desc = desc.substring(0, 17)
                            }
                            listbook += `<div class="col-sm-9 col-md-3"><div class="thumbnail" ><img style="width: 200px;height: 300px" src="` + imgurl + `\"><div class="caption"><h4>`
                                + bookname +
                                `</h4><p>` + desc +
                                `</p><p><a href="#" class="btn btn-primary" role="button">加入购物车</a> <a href="#" class="btn btn-default" role="button">查看详情` +
                                `</a></p></div></div> </div>`;
                        }
                        document.getElementById("book").innerHTML = listbook;
                    }
                }
                xmlHttp.send();
            } else {
                xmlHttp.open("GET", "/book/selectBooksByCategory?category=" + category, true);
                xmlHttp.onreadystatechange = function () {
                    if (xmlHttp.readyState == 4) {
                        var data = xmlHttp.responseText;
                        var obj = JSON.parse(data);
                        var listbook = '';
                        for (var i in obj) {
                            var bookname = obj[i].name;
                            var desc = obj[i].introduction;
                            var imgurl = obj[i].imgurl;
                            if (desc.length > 20) {
                                desc = desc.substring(0, 17)
                            }
                            listbook += `<div class="col-sm-9 col-md-3"><div class="thumbnail" ><img style="width: 200px;height: 300px" src="` + imgurl + `\"><div class="caption"><h4>`
                                + bookname +
                                `</h4><p>` + desc +
                                `</p><p><a href="#" class="btn btn-primary" role="button">加入购物车</a> <a href="#" class="btn btn-default" role="button">查看详情` +
                                `</a></p></div></div> </div>`;
                        }
                        document.getElementById("book").innerHTML = listbook;
                    }
                }
                xmlHttp.send();
            }
        }
        function GetQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);
            return null;
        }
        function getUserName() {
            var username = GetQueryString("account");
            if(username!= null) {
                var dom1 = document.getElementById("top_right");
                dom1.innerHTML = "欢迎用户"+username;
            }
        }
    </script>
</body>
</html>